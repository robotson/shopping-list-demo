<html>
<head></head>
<body>
<div id='root'></div>
<script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/react-router-dom/umd/react-router-dom.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-auth.js"></script>
<script type="text/babel" defer>
    React;
    let Router = ReactRouterDOM.HashRouter;
    let Route = ReactRouterDOM.Route;
    let Link = ReactRouterDOM.Link;
    let version = '0.0.7';
    

    let firebaseConfig = {
        apiKey: "AIzaSyBEcmX7MPOlaDMrpAdNb426q6yTbhdkvts",
        authDomain: "robotson-shopping-list.firebaseapp.com",
        databaseURL: "https://robotson-shopping-list.firebaseio.com",
        projectId: "robotson-shopping-list",
        storageBucket: "robotson-shopping-list.appspot.com",
        messagingSenderId: "760807369962",
        appId: "1:760807369962:web:5ab3d866f6b3478b"
    };

    firebase.initializeApp(firebaseConfig);
    let provider = new firebase.auth.TwitterAuthProvider();

    function signInWithTwitterButtonHandler(event){
        firebase.auth().signInWithRedirect(provider);
    }
    // firebase.auth().getRedirectResult().then(function(result) {
    //     if (result.credential) {
    //         var token = result.credential.accessToken;
    //         var secret = result.credential.secret;
    //     }
    //     var user = result.user;
    // });

    firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
            let welcomeBackMessage = document.createElement('p');
            welcomeBackMessage.id = "welcome-message";
            welcomeBackMessage.appendChild(document.createTextNode("Welcome back!"));
            document.getElementById('root').appendChild(welcomeBackMessage);
        } else {
            let signInButton = document.createElement('button');
            signInButton.appendChild(document.createTextNode("Sign-In With Twitter"));
            signInButton.addEventListener('click', signInWithTwitterButtonHandler);
            document.getElementById('root').appendChild(signInButton);
        }
    });

    function Index() {
        return <h2>Home</h2>;
    }

    function About() {
        return <h2>About</h2>;
    }

    function Users() {
        return <h2>Users</h2>;
    }

    function AppRouter() {
        return (
            <Router>
            <div>
                <nav>
                <ul>
                    <li>
                    <Link to="/">Home</Link>
                    </li>
                    <li>
                    <Link to="/about/">About</Link>
                    </li>
                    <li>
                    <Link to="/users/">Users</Link>
                    </li>
                </ul>
                </nav>

                <Route path="/" exact component={Index} />
                <Route path="/about/" component={About} />
                <Route path="/users/" component={Users} />
            </div>
            </Router>
        );
    }

    ReactDOM.render(
        <h1>demo v{version}</h1>,
        <AppRouter />,
        document.getElementById('root')
    );
</script>
</body>
</html>